(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[60],{5593:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/surveys",function(){return t(9209)}])},9209:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return d}});var n=t(7568),i=t(7582),o=t(5893),s=t(7294),c=t(1163);function d(){var e,r=(0,c.useRouter)(),t=(0,s.useState)(!0),d=t[0],a=t[1],l=(0,s.useState)(""),u=l[0],m=l[1],f=(0,s.useState)([]),h=f[0],p=f[1];(0,s.useEffect)(function(){x()},[]);var g,x=(e=(0,n.Z)(function(){var e,t,n;return(0,i.__generator)(this,function(t){switch(t.label){case 0:if(t.trys.push([0,3,4,5]),a(!0),!(e=localStorage.getItem("token")))return m("请先登录后再查看问卷列表"),a(!1),setTimeout(function(){r.push("/login?returnTo=/surveys")},2e3),[2];return[4,fetch("/api/surveys/list",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}})];case 1:return[4,t.sent().json()];case 2:return(n=t.sent()).success?p(n.data.surveys||[]):m(n.message||"获取问卷列表失败"),[3,5];case 3:return t.sent(),m("网络错误，请稍后重试"),[3,5];case 4:return a(!1),[7];case 5:return[2]}})}),function(){return e.apply(this,arguments)}),b=function(e){var r=new Date(e);return r.toLocaleDateString("zh-CN")+" "+r.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})},y=function(){r.push("/create-survey")},v=function(e){var t;(null===(t=e.questions)||void 0===t?void 0:t.some(function(e){return"PROJECT"===e.type}))?r.push("/survey-weighted/".concat(e.id)):r.push("/survey/".concat(e.id))},j=function(e){r.push("/edit-survey?id=".concat(e))},w=(g=(0,n.Z)(function(e,t){var n,o,s;return(0,i.__generator)(this,function(i){switch(i.label){case 0:if(!confirm('确定要删除问卷"'.concat(t,'"吗？此操作不可撤销！')))return[2];i.label=1;case 1:if(i.trys.push([1,4,,5]),!(n=localStorage.getItem("token")))return alert("请先登录"),r.push("/login"),[2];return[4,fetch("/api/surveys/delete?id=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(n)}})];case 2:return[4,i.sent().json()];case 3:return(s=i.sent()).success?(alert("问卷删除成功！"),x()):alert(s.message||"删除失败"),[3,5];case 4:return i.sent(),alert("删除失败，请稍后重试"),[3,5];case 5:return[2]}})}),function(e,r){return g.apply(this,arguments)}),S=function(e,r,t){var n,i=(null===(n=t.questions)||void 0===n?void 0:n.some(function(e){return"PROJECT"===e.type}))?"".concat(window.location.origin,"/answer-weighted/").concat(e):"".concat(window.location.origin,"/answer/").concat(e);navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(i).then(function(){alert('问卷"'.concat(r,'"的链接已复制到剪贴板！\n\n链接地址：').concat(i))}).catch(function(){k(i,r)}):k(i,r)},k=function(e,r){var t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select();try{document.execCommand("copy")?alert('问卷"'.concat(r,'"的链接已复制到剪贴板！\n\n链接地址：').concat(e)):alert("复制失败，请手动复制链接："+e)}catch(n){alert("复制失败，请手动复制链接："+e)}document.body.removeChild(t)};return d?(0,o.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"sans-serif"},children:(0,o.jsxs)("div",{style:{textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"⏳"}),(0,o.jsx)("p",{style:{color:"#6b7280"},children:"加载中..."})]})}):(0,o.jsx)("div",{style:{minHeight:"100vh",background:"#f8fafc",fontFamily:"sans-serif"},children:(0,o.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"2rem 1rem"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,o.jsx)("button",{onClick:function(){return r.push("/")},style:{background:"#6b7280",color:"white",padding:"0.5rem 1rem",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500",display:"flex",alignItems:"center",gap:"0.5rem"},children:"← 返回首页"}),(0,o.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"700",color:"#1f2937",margin:0},children:"我的问卷"})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[(0,o.jsx)("button",{onClick:function(){return r.push("/create-weighted-survey")},style:{background:"#8b5cf6",color:"white",padding:"0.75rem 1.5rem",border:"none",borderRadius:"0.5rem",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:"⚖️ 创建权重问卷"}),(0,o.jsx)("button",{onClick:y,style:{background:"#3b82f6",color:"white",padding:"0.75rem 1.5rem",border:"none",borderRadius:"0.5rem",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:"+ 创建新问卷"})]})]}),u&&(0,o.jsx)("div",{style:{background:"#fee2e2",border:"1px solid #fecaca",color:"#dc2626",padding:"1rem",borderRadius:"0.5rem",marginBottom:"2rem"},children:u}),0===h.length?(0,o.jsxs)("div",{style:{textAlign:"center",padding:"4rem 2rem",background:"white",borderRadius:"0.5rem",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[(0,o.jsx)("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"\uD83D\uDCCB"}),(0,o.jsx)("h3",{style:{fontSize:"1.5rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"还没有创建问卷"}),(0,o.jsx)("p",{style:{color:"#6b7280",marginBottom:"2rem",fontSize:"1rem"},children:"选择适合您需求的问卷类型开始收集反馈吧！"}),(0,o.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"center",flexWrap:"wrap"},children:[(0,o.jsx)("button",{onClick:function(){return r.push("/create-weighted-survey")},style:{background:"#8b5cf6",color:"white",padding:"0.75rem 2rem",border:"none",borderRadius:"0.5rem",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:"⚖️ 创建权重问卷"}),(0,o.jsx)("button",{onClick:y,style:{background:"#3b82f6",color:"white",padding:"0.75rem 2rem",border:"none",borderRadius:"0.5rem",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:"+ 创建普通问卷"})]}),(0,o.jsxs)("div",{style:{marginTop:"2rem",color:"#6b7280",fontSize:"0.875rem"},children:[(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"权重问卷："})," 支持项目-维度-选项层级结构，可配置权重计算得分"]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"普通问卷："})," 支持单选、多选、打分等基础问题类型"]})]})]}):(0,o.jsx)("div",{style:{display:"grid",gap:"1.5rem",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))"},children:h.map(function(e){var r,t,n,i;return(0,o.jsxs)("div",{style:{background:"white",borderRadius:"0.75rem",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",padding:"1.5rem",border:"1px solid #e5e7eb"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[(0,o.jsx)("h3",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#1f2937",margin:0,flex:1},children:e.title}),(0,o.jsx)("span",{style:{background:{DRAFT:"#6b7280",PUBLISHED:"#10b981",PAUSED:"#f59e0b",CLOSED:"#ef4444",active:"#3b82f6"}[n=e.status]||"#6b7280",color:"white",padding:"0.25rem 0.75rem",borderRadius:"1rem",fontSize:"0.75rem",fontWeight:"500"},children:{DRAFT:"草稿",PUBLISHED:"已发布",PAUSED:"已暂停",CLOSED:"已关闭",active:"活跃"}[i=e.status]||i})]}),e.description&&(0,o.jsx)("p",{style:{color:"#6b7280",marginBottom:"1rem",fontSize:"0.875rem",lineHeight:"1.5"},children:e.description}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"问题数量"}),(0,o.jsx)("div",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#1f2937"},children:(null===(r=e._count)||void 0===r?void 0:r.questions)||0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:"回答数量"}),(0,o.jsx)("div",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#1f2937"},children:(null===(t=e._count)||void 0===t?void 0:t.responses)||0})]})]}),(0,o.jsxs)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"1.5rem"},children:["创建时间: ",b(e.createdAt)]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[(0,o.jsx)("button",{onClick:function(){return v(e)},style:{flex:"1 1 60px",background:"#f3f4f6",color:"#374151",padding:"0.5rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",minWidth:"60px"},children:"查看"}),(0,o.jsx)("button",{onClick:function(){return j(e.id)},style:{flex:"1 1 60px",background:"#3b82f6",color:"white",padding:"0.5rem 0.75rem",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",minWidth:"60px"},children:"编辑"}),(0,o.jsx)("button",{onClick:function(){return S(e.id,e.title,e)},style:{flex:"1 1 80px",background:"#10b981",color:"white",padding:"0.5rem 0.75rem",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",minWidth:"80px"},children:"复制链接"}),(0,o.jsx)("button",{onClick:function(){return w(e.id,e.title)},style:{flex:"1 1 60px",background:"#ef4444",color:"white",padding:"0.5rem 0.75rem",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",minWidth:"60px"},children:"删除"})]})]},e.id)})})]})})}},1163:function(e,r,t){e.exports=t(387)},7568:function(e,r,t){"use strict";function n(e,r,t,n,i,o,s){try{var c=e[o](s),d=c.value}catch(a){t(a);return}c.done?r(d):Promise.resolve(d).then(n,i)}function i(e){return function(){var r=this,t=arguments;return new Promise(function(i,o){var s=e.apply(r,t);function c(e){n(s,i,o,c,d,"next",e)}function d(e){n(s,i,o,c,d,"throw",e)}c(void 0)})}}t.d(r,{Z:function(){return i}})}},function(e){e.O(0,[774,888,179],function(){return e(e.s=5593)}),_N_E=e.O()}]);